# Mluv.Me ‚Äî –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –ø—Ä–æ–µ–∫—Ç–∞

**–î–∞—Ç–∞:** 18 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–°—Ä–µ–¥–∞:** Railway.com (production), Redis healthy  
**–°—Ç–µ–∫:** FastAPI + Next.js 14 + aiogram 3 + PostgreSQL + Redis + Celery

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–†–µ–∑—é–º–µ](#1-—Ä–µ–∑—é–º–µ)
2. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏](#2-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–±–∞–≥–∏)
3. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#3-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
4. [Backend ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–¥](#4-backend--–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∏-–∫–æ–¥)
5. [Frontend ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–¥](#5-frontend--–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∏-–∫–æ–¥)
6. [Telegram Bot](#6-telegram-bot)
7. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏](#7-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-–º–æ–¥–µ–ª–∏)
8. [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#8-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
9. [OpenAI ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç](#9-openai--–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–∑–∞—Ç—Ä–∞—Ç)
10. [–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –¥–µ–ø–ª–æ–π](#10-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–∏-–¥–µ–ø–ª–æ–π)
11. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#11-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
12. [UX/UI –ø—Ä–æ–±–ª–µ–º—ã](#12-uxui-–ø—Ä–æ–±–ª–µ–º—ã)
13. [–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è](#13-–º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è)
14. [–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π](#14-–ø–ª–∞–Ω-–¥–µ–π—Å—Ç–≤–∏–π)

---

## 1. –†–µ–∑—é–º–µ

### –ß—Ç–æ —Ö–æ—Ä–æ—à–æ
- –ë–æ–≥–∞—Ç—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª: 18+ —Å–µ—Ä–≤–∏—Å–æ–≤ (GPT-4o, Whisper, TTS, –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞, –∏–≥—Ä—ã, —Å—Ü–µ–Ω–∞—Ä–∏–∏, SR, –∞—á–∏–≤–∫–∏)
- Celery beat + 5 cron-–∑–∞–¥–∞—á —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–≥–∏—á–Ω–∞—è –∏ —á–∏—Ç–∞–µ–º–∞—è
- –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã, –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic –∞–∫—Ç—É–∞–ª—å–Ω—ã

### –ß—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º | –°—Ç–∞—Ç—É—Å |
|---|---|---|
| üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ | 5 | ‚úÖ –í—Å–µ 5 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |
| üî¥ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (critical/high) | 8 | ‚úÖ –í—Å–µ 8 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |
| üü° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (medium) | 4 | ‚úÖ –í—Å–µ 4 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |
| üü° –°—Ä–µ–¥–Ω–∏–µ –±–∞–≥–∏ (frontend) | 5 | ‚úÖ 4 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, 1 –Ω–µ –±–∞–≥ |
| üü° In-memory —É—Ç–µ—á–∫–∏ | 5 | ‚úÖ –í—Å–µ 5 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (TTL+cap) |
| üü° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 10 | ‚úÖ N+1 fix, prompt caching |
| üü¢ Code quality / dead code | 15+ | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| üü¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 6 test files | ‚úÖ ~30%+ coverage |
| üü¢ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | CI/CD + Sentry | ‚úÖ GitHub Actions + Sentry SDK |
| üí∞ –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è | **$0 revenue –ø—Ä–∏ –≥–æ—Ç–æ–≤–æ–π premium-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏** | ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ |
| üü£ –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ | Honz√≠k + pan√≠ Nov√°kov√°, –≤—ã–±–æ—Ä –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| üü£ –°–∫–æ—Ä–æ—Å—Ç—å Honz√≠ka | –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã, —É–±—Ä–∞–Ω overhead | ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ |

---

## 2. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´

### BUG-1: –¢–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ —á–µ—Ä–µ–∑ WebApp ‚úÖ
**–§–∞–π–ª:** `frontend/app/(auth)/login/page.tsx` (—Å—Ç—Ä–æ–∫–∞ ~78)  
**–ü—Ä–æ–±–ª–µ–º–∞:** `handleWebAppLogin` –≤—ã–∑—ã–≤–∞–µ—Ç `setUser(result.user)`, –Ω–æ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç `setToken(result.token)`**. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ API-–∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.  
**–í–ª–∏—è–Ω–∏–µ:** –í–µ–±-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram WebApp —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–ª–æ–º–∞–Ω–∞.  
**–§–∏–∫—Å:** –î–æ–±–∞–≤–∏—Ç—å `setToken(result.token)` –ø–æ—Å–ª–µ `setUser(result.user)`.

### BUG-2: user.settings –º–æ–∂–µ—Ç –±—ã—Ç—å None ‚Üí AttributeError ‚úÖ
**–§–∞–π–ª—ã:** `backend/routers/lesson.py` (~10 –º–µ—Å—Ç), `backend/routers/gamification.py` (3 –º–µ—Å—Ç–∞)  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ `user.settings.conversation_style`, `user.settings.timezone` –∏ —Ç.–¥. –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `None`. –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ `UserSettings`, –ø–æ–ª—É—á–∏—Ç `AttributeError: 'NoneType' object has no attribute 'conversation_style'`.  
**–í–ª–∏—è–Ω–∏–µ:** Crash –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —É—Ä–æ–∫–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫.  
**–§–∏–∫—Å:** –î–æ–±–∞–≤–∏—Ç—å null-safe access: `getattr(user.settings, 'conversation_style', 'friendly')` –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### BUG-3: –ö—ç—à Honzik ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á (native_language) ‚úÖ
**–§–∞–π–ª:** `backend/services/honzik_personality.py` (—Å—Ç—Ä–æ–∫–∞ ~267)  
**–ü—Ä–æ–±–ª–µ–º–∞:** `settings_dict` –¥–ª—è –∫–ª—é—á–∞ –∫—ç—à–∞ –≤–∫–ª—é—á–∞–µ—Ç `czech_level`, `correction_level`, `conversation_style`, –Ω–æ **–Ω–µ –≤–∫–ª—é—á–∞–µ—Ç `native_language`**. –î–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —É—Ä–æ–≤–Ω–µ–º, –Ω–æ —Ä–∞–∑–Ω—ã–º–∏ —è–∑—ã–∫–∞–º–∏ (ru/uk) –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å —á—É–∂–æ–π –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç.  
**–í–ª–∏—è–Ω–∏–µ:** –£–∫—Ä–∞–∏–Ω–æ—è–∑—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.

### BUG-4: –ö—ç—à TTS ‚Äî –º–æ–¥–µ–ª—å hardcoded –∫–∞–∫ "gpt-4o" ‚úÖ
**–§–∞–π–ª:** `backend/services/cache_service.py` (—Å—Ç—Ä–æ–∫–∞ ~216)  
**–ü—Ä–æ–±–ª–µ–º–∞:** `get_cached_honzik_response` —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç `"gpt-4o"` –≤ –∫–ª—é—á–µ –∫—ç—à–∞, –Ω–æ —Ä–µ–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ (gpt-4o-mini). –û—Ç–≤–µ—Ç –æ—Ç mini –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –∫–ª—é—á–æ–º gpt-4o ‚Üí –∫—Ä–æ—Å—Å-–∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –∫—ç—à–∞.

### BUG-5: web_lessons.py –ø–µ—Ä–µ–¥–∞—ë—Ç ui_language –≤–º–µ—Å—Ç–æ native_language ‚úÖ
**–§–∞–π–ª:** `backend/routers/web_lessons.py` (—Å—Ç—Ä–æ–∫–∞ ~94)  
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—ã–∑—ã–≤–∞–µ—Ç `honzik.generate_response()` —Å `ui_language=user.native_language`, –Ω–æ –≤ `lesson.py` —Ç–æ—Ç –∂–µ —Å–µ—Ä–≤–∏—Å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å `native_language=user.native_language`. –û–¥–∏–Ω –∏–∑ –Ω–∏—Ö –ø–µ—Ä–µ–¥–∞—ë—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π kwarg ‚Üí –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç TypeError.

---

## 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´

### üî¥ CRITICAL ‚Äî ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|---|
| SEC-1 | **–ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π Bot Token** | `bot/config.py:17` | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –ª–µ–∂–∏—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ: `7471812936:AAFoji...`. –ö—Ç–æ —É–≥–æ–¥–Ω–æ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–µ–ø–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –±–æ—Ç–∞. **–ù—É–∂–Ω–æ —Ä–æ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ BotFather –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ.** | ‚úÖ –î–µ—Ñ–æ–ª—Ç —É–¥–∞–ª—ë–Ω |
| SEC-2 | **–ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π Bot Token** | `backend/config.py:44` | –¢–æ—Ç –∂–µ —Ç–æ–∫–µ–Ω –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –±—ç–∫–µ–Ω–¥-–∫–æ–Ω—Ñ–∏–≥–µ –∫–∞–∫ default. | ‚úÖ –î–µ—Ñ–æ–ª—Ç —É–¥–∞–ª—ë–Ω |
| SEC-3 | **–ù–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ API** | –í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã | –í–°–ï 12 —Ä–æ—É—Ç–µ—Ä–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—é—Ç `user_id`/`telegram_id` –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏. –õ—é–±–æ–π HTTP-–∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å/–º–µ–Ω—è—Ç—å/—É–¥–∞–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. | ‚úÖ `get_authenticated_user` dependency |
| SEC-4 | **–ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π admin secret** | `backend/routers/grammar.py:293` | `os.getenv("ADMIN_SECRET", "mluv-seed-2026")` ‚Äî –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∑–∞–¥–∞–Ω–∞, —Å–µ–∫—Ä–µ—Ç ‚Äî –≤ –∫–æ–¥–µ. –ü–ª—é—Å –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ query param ‚Üí –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ access logs. | ‚úÖ –î–µ—Ñ–æ–ª—Ç —É–±—Ä–∞–Ω, –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ Header |

### üü° HIGH ‚Äî ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|---|
| SEC-5 | **–°–µ—Å—Å–∏–∏ –≤ –ø–∞–º—è—Ç–∏** | `backend/routers/web_auth.py:60` | `sessions: dict` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ RAM ‚Üí —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ. –ù–µ—Ç –ª–∏–º–∏—Ç–∞ ‚Üí DoS —á–µ—Ä–µ–∑ —Ñ–ª—É–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–π. | ‚úÖ MAX_SESSIONS=5000 + TTL |
| SEC-6 | **JWT –≤ localStorage** | `frontend/lib/auth-store.ts:36` | –¢–æ–∫–µ–Ω –≤ localStorage —É—è–∑–≤–∏–º –∫ XSS. –ù—É–∂–Ω—ã httpOnly cookies. | ‚úÖ httpOnly cookie –¥–æ–±–∞–≤–ª–µ–Ω |
| SEC-7 | **DELETE –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è** | `backend/routers/words.py:174` | `DELETE /{word_id}` —É–¥–∞–ª—è–µ—Ç –ª—é–±–æ–µ —Å–ª–æ–≤–æ –ø–æ ID –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏. | ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ user_id |
| SEC-8 | **Push –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** | `frontend/lib/push-notifications.ts:167` | `saveSubscriptionToServer` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `fetch` –≤–º–µ—Å—Ç–æ `apiClient` ‚Üí –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –±–µ–∑ —Ç–æ–∫–µ–Ω–∞. | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ apiClient |

### üü¢ MEDIUM ‚Äî ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| SEC-9 | `datetime.utcnow()` deprecated | Python 3.12+ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `datetime.now(timezone.utc)` | ‚úÖ 21 –∑–∞–º–µ–Ω–∞ –≤ 10 —Ñ–∞–π–ª–∞—Ö |
| SEC-10 | Session token –≤ query string | `GET /me` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–∫–µ–Ω –∫–∞–∫ query param ‚Üí –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ª–æ–≥–∏ –∏ browser history | ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `get_authenticated_user` dependency |
| SEC-11 | Admin secret –≤ query string | –û–±–∞ admin endpoint `/admin/seed` –∏ `/admin/send-notifications` | ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ `X-Admin-Secret` Header |
| SEC-12 | Logout –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–Ω–∏—è | `POST /logout` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ª—é–±–æ–π —Ç–æ–∫–µ–Ω –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ | ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `_resolve_session_token` |

---

## 4. Backend ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–¥

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
| –ü—Ä–æ–±–ª–µ–º–∞ | –ì–¥–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|
| User response dict –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 3 —Ä–∞–∑–∞ | `web_auth.py` (—Å—Ç—Ä–æ–∫–∏ 148, 206, 351) | ‚úÖ –ò–∑–≤–ª–µ—á—ë–Ω `_user_response_dict()` helper |
| Settings update –ª–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 3 —Ä–∞–∑–∞ | `users.py` | ‚¨ú |
| User lookup + 404 –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è ~25 —Ä–∞–∑ | –í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã | ‚¨ú |
| `web_lessons.py POST /text` –¥—É–±–ª–∏—Ä—É–µ—Ç `lesson.py POST /process/text` | –î–≤–µ —Ä–∞–∑–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–æ–π –ª–æ–≥–∏–∫–∏ | ‚¨ú |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `get_authenticated_user()` FastAPI Dependency –¥–ª—è –∏–Ω—ä–µ–∫—Ü–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ user response –≤ `_user_response_dict()` helper
- ‚¨ú –°–æ–∑–¥–∞—Ç—å `UserSettingsSafe` helper —Å fallback –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- ‚¨ú –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å `web_lessons.py` —Å `lesson.py`
- ‚úÖ `OpenAIClient()` –≤ `web_lessons.py` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω ‚Äî —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `get_settings()` singleton

### In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (—É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏) ‚úÖ –í–°–ï –ü–ï–†–ï–í–ï–î–ï–ù–û –í REDIS
| Dict | –§–∞–π–ª | –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| `sessions` | `web_auth.py` | –ù–µ –æ—á–∏—â–∞–µ—Ç—Å—è, –Ω–µ—Ç TTL | ‚úÖ Redis `session:{token}` TTL=30d |
| `onboarding_data` | `bot/handlers/start.py` | –ù–µ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–º –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ | ‚úÖ MAX=500, TTL=3600s |
| `_corrections_cache` | `bot/handlers/voice.py` | –ß–∏—Å—Ç–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ | ‚úÖ MAX=1000, overflow eviction |
| `_active_games` | `backend/services/game_service.py` | –ù–µ —à–∞—Ä–∏—Ç—Å—è –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏, –Ω–µ—Ç TTL | ‚úÖ Redis `game:active:{uid}` TTL=30min |
| `_active_scenarios` | `backend/services/scenario_service.py` | –ù–µ —à–∞—Ä–∏—Ç—Å—è –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏, –Ω–µ—Ç TTL | ‚úÖ Redis `scenario:active:{uid}` TTL=1hr |

**‚úÖ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ:** Sessions, games, scenarios –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ Redis —Å TTL. In-memory dict'—ã —É–±—Ä–∞–Ω—ã. Binary pool –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (shared connection pool –≤–º–µ—Å—Ç–æ per-call).

---

## 5. Frontend ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–¥

### –ë–∞–≥–∏ ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| FE-1 | **–¢–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ** (—Å–º. BUG-1) | `login/page.tsx` | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| FE-2 | `useOptimisticMutations` ‚Äî `user_mistakes` –º–∞–ø–ø–∏—Ç—Å—è –Ω–∞ `string[]` –≤–º–µ—Å—Ç–æ `Mistake[]` | `hooks/useOptimisticMutations.ts:87` | ‚úÖ –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞—ë—Ç `Mistake[]` |
| FE-3 | `telegramId=0` –µ—Å–ª–∏ user=null ‚Üí –∑–∞–ø—Ä–æ—Å —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º ID | `practice/page.tsx:60` | ‚úÖ Guard `if (!user?.telegram_id) return` |
| FE-4 | 401 interceptor –≤—ã–∑—ã–≤–∞–µ—Ç logout –Ω–∞ **–∫–∞–∂–¥—ã–π** 401, –≤–∫–ª—é—á–∞—è login | `api-client.ts:48` | ‚úÖ –°–∫–∏–ø –¥–ª—è `/auth/` endpoints |
| FE-5 | `hasSeenWelcomeVideo()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ (–Ω–µ –≤ useEffect) ‚Üí hydration mismatch | `dashboard/page.tsx:53` | ‚úÖ –ù–µ –±–∞–≥ ‚Äî —É–∂–µ –≤ useEffect |

### Dead code ‚úÖ –í–°–Å –£–î–ê–õ–ï–ù–û
| –ß—Ç–æ | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
|---|---|---|
| `useRequireAuth()` ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | `auth-store.ts:78` | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |
| `useAuth()` ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | `auth-store.ts:71` | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |
| `validateTelegramAuth()` ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è | `telegram-auth.ts:54` | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |
| `initTelegramAuth()` ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | `telegram-auth.ts:26` | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |
| `applyTheme()` ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | `theme-store.ts:36` | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |
| `AnalyticsData`, `WeeklyStats`, `DailyActivity` —Ç–∏–ø—ã | `types.ts:105` | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |
| –ò–º–ø–æ—Ä—Ç—ã `dynamic`, `Skeleton`, `Trophy`, `Star` | layout.tsx, learn/page.tsx | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
| –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª |
|---|---|
| `refetchOnMount: "always"` –æ—Ç–º–µ–Ω—è–µ—Ç `staleTime` | `providers.tsx:14` |
| Telegram SDK –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ | `layout.tsx:36` |
| Leaderboard –∏ Challenges –∏—Å–ø–æ–ª—å–∑—É—é—Ç useState + useEffect –≤–º–µ—Å—Ç–æ React Query | `Leaderboard.tsx`, `learn/page.tsx` |
| `filteredWords` –Ω–µ –æ–±—ë—Ä–Ω—É—Ç –≤ `useMemo` | `SavedWordsTab.tsx:109` |
| Preload –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö, –≥–¥–µ –æ–Ω–∏ –Ω–µ –Ω—É–∂–Ω—ã | `layout.tsx:33` |

---

## 6. Telegram Bot

### –ë–∞–≥–∏

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| BOT-1 | `onboarding_data` dict —Ä–∞—Å—Ç—ë—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ | `handlers/start.py:21` | ‚úÖ MAX=500, TTL=3600s |
| BOT-2 | `_corrections_cache` dict —Ä–∞—Å—Ç—ë—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ | `handlers/voice.py:34` | ‚úÖ MAX=1000, overflow eviction |
| BOT-3 | `random.seed()` –º—É—Ç–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–Ω–µ thread-safe) | `services/challenge_service.py:68` | ‚úÖ `random.Random(hash(...))` |
| BOT-4 | `aiohttp.ClientSession` –±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞ (default 300s) | `services/api_client.py:29` | ‚úÖ `ClientTimeout(total=30, connect=10)` |
| BOT-5 | Settings-change –∫–æ–ª–ª–±—ç–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç —Å onboarding –∫–æ–ª–ª–±—ç–∫–∞–º–∏ | `handlers/commands.py` vs `start.py` | ‚¨ú |

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- `voice.py` –∏ `text.py` —Å–æ–¥–µ—Ä–∂–∞—Ç >50% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞ (–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞, –∫–Ω–æ–ø–∫–∏, –∫—ç—à –∫–æ—Ä—Ä–µ–∫—Ü–∏–π)
- –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `api_client.get_user()` –∑–∞–Ω–æ–≤–æ, –¥–∞–∂–µ –≤ callback –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã

---

## 7. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏

### –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
| –¢–∞–±–ª–∏—Ü–∞ | –ß—Ç–æ –Ω—É–∂–Ω–æ |
|---|---|
| `daily_stats` | Composite UNIQUE –Ω–∞ `(user_id, date)` ‚Äî —Å–µ–π—á–∞—Å –≤–æ–∑–º–æ–∂–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã |
| `saved_words` | –ò–Ω–¥–µ–∫—Å –Ω–∞ `next_review_date` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å–ª–æ–≤ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ |

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
**–§–∞–π–ª:** `backend/db/repositories.py:82`  
`get_by_telegram_id` –≤–æ—Å—Å–æ–∑–¥–∞—ë—Ç `User` –∏–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ dict —á–µ—Ä–µ–∑ `User(**cached)`, —Å–æ–∑–¥–∞–≤–∞—è **detached SQLAlchemy –æ–±—ä–µ–∫—Ç**. –õ—é–±–æ–π lazy-load relationship (`user.settings`, `user.messages`) –≤—ã–±—Ä–æ—Å–∏—Ç `DetachedInstanceError`. ISO-—Å—Ç—Ä–æ–∫–∏ `created_at`/`updated_at` –Ω–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ `datetime`.

### –ü—Ä–æ–±–ª–µ–º–∞ —Å selectinload + limit
**–§–∞–π–ª:** `backend/db/repositories.py:193`  
`.limit()` –Ω–∞ `selectinload` **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è** SQLAlchemy ‚Äî –º–æ–ª—á–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –∑–∞–≥—Ä—É–∂–∞—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏.

---

## 8. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### N+1 Query –ø—Ä–æ–±–ª–µ–º—ã
| –§–∞–π–ª | Endpoint | –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| `achievement_service.py:112` | `check_achievements` | –î–ª—è –∫–∞–∂–¥–æ–π –∞—á–∏–≤–∫–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å ‚Üí 50+ –∑–∞–ø—Ä–æ—Å–æ–≤ | ‚¨ú |
| `grammar.py:259` | `GET /progress/details` | –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–π `get_rule_by_id()` | ‚úÖ `joinedload` |
| `challenge_service.py` | `_calculate_progress` | –û—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —á–µ–ª–ª–µ–Ω–¥–∂–∞ | ‚¨ú |
| `gamification.py:488` | `GET /leaderboard/my-rank` | –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Üí –º–æ–∂–Ω–æ `RANK()` window function | ‚¨ú |

### –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏
| –§–∞–π–ª | –ü—Ä–æ–±–ª–µ–º–∞ |
|---|---|
| `words.py:449` | `GET /review-stats` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï —Å–ª–æ–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Python –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞. –ù—É–∂–Ω–∞ SQL –∞–≥—Ä–µ–≥–∞—Ü–∏—è. |
| `gamification.py:342` | `GET /achievements/category` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –∞—á–∏–≤–∫–∏, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –≤ Python. –ù—É–∂–µ–Ω WHERE –≤ SQL. |
| `lesson.py:175` | 10 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏ —Ä–µ–≤–µ—Ä—Å–∏—Ä—É—é—Ç—Å—è –≤ Python. –ù—É–∂–µ–Ω `ORDER BY`. |

### Race conditions
| –§–∞–π–ª | –ü—Ä–æ–±–ª–µ–º–∞ |
|---|---|
| `gamification.py:128` | `award_stars` –¥–µ–ª–∞–µ—Ç read-then-write –≤–º–µ—Å—Ç–æ `UPDATE SET total = total + N` |
| `gamification.py:276` | `check_daily_challenge` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `messages_today == 5` (exactly equal). –ü—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –º–æ–∂–µ—Ç –ø–µ—Ä–µ–ø—Ä—ã–≥–Ω—É—Ç—å 5. |

---

## 9. OpenAI ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç

### –ü—Ä–æ–±–ª–µ–º—ã

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –≠–∫–æ–Ω–æ–º–∏—è |
|---|---|---|
| AI-1 | System prompt (~600-1000 —Ç–æ–∫–µ–Ω–æ–≤) –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ù—É–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø–æ `(level, corrections_level, native_language, style)` | ‚úÖ `@lru_cache(maxsize=64)` –Ω–∞ `_get_base_prompt` |
| AI-2 | `honzik_personality.py:236` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –±–µ—Å–µ–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–¥–≤–∞–∂–¥—ã**: –∫–∞–∫ —Ç–µ–∫—Å—Ç –≤ user prompt –ò –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ messages. –î–≤–æ–π–Ω–æ–π —Ä–∞—Å—Ö–æ–¥ —Ç–æ–∫–µ–Ω–æ–≤ | ‚úÖ –ü—É—Å—Ç–∞—è –∏—Å—Ç–æ—Ä–∏—è ‚Üí –±–ª–æ–∫ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è |
| AI-3 | `MAX_TTS_CACHE_LENGTH = 200` —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ TTS –æ—Ç–≤–µ—Ç–æ–≤ –Ω–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è (Honzik –æ–±—ã—á–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç 200-500 —Å–∏–º–≤–æ–ª–æ–≤) | –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 500 ‚Üí —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –Ω–∞ TTS |
| AI-4 | `MODEL_PRICING` dict –∏ `TOKEN_LIMITS` dict –≤ `openai_client.py` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã, –Ω–æ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è** | ‚úÖ –£–¥–∞–ª—ë–Ω dead code |
| AI-5 | `OpenAIClient.get_optimal_model()` ‚Äî dead code, `model_selector.py` –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ | ‚úÖ –£–¥–∞–ª—ë–Ω –¥—É–±–ª–∏–∫–∞—Ç |
| AI-6 | `web_lessons.py` —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π `OpenAIClient()` –Ω–∞ **–∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å** –≤–º–µ—Å—Ç–æ singleton | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: `get_settings()` + singleton |

### –û—Ü–µ–Ω–∫–∞ –∑–∞—Ç—Ä–∞—Ç
–ü—Ä–∏ 100 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (10 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å):
- GPT-4o: ~$0.03/msg = **$30/–¥–µ–Ω—å**
- GPT-4o-mini: ~$0.003/msg = **$3/–¥–µ–Ω—å** (model_selector –∞–∫—Ç–∏–≤–µ–Ω, ~70% –Ω–∞ mini)
- TTS: ~$0.015/msg = **$15/–¥–µ–Ω—å**
- STT: ~$0.006/msg = **$6/–¥–µ–Ω—å**
- **–ò—Ç–æ–≥–æ: ~$20-30/–¥–µ–Ω—å ‚âà $600-900/–º–µ—Å—è—Ü** –ø—Ä–∏ 100 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö

---

## 10. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –¥–µ–ø–ª–æ–π

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
Railway.com (1 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
‚îú‚îÄ‚îÄ FastAPI backend (:8000)
‚îú‚îÄ‚îÄ Next.js frontend (:3000) ‚Äî –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ FastAPI
‚îú‚îÄ‚îÄ Telegram bot (polling)
‚îú‚îÄ‚îÄ Celery worker (2 concurrency)
‚îú‚îÄ‚îÄ Celery beat (scheduler)
‚îú‚îÄ‚îÄ PostgreSQL (Railway plugin)
‚îî‚îÄ‚îÄ Redis (Railway plugin)
```

### –†–∏—Å–∫–∏
| # | –ü—Ä–æ–±–ª–µ–º–∞ | –£—Ä–æ–≤–µ–Ω—å |
|---|---|---|
| INFRA-1 | **–û–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä = –æ–¥–Ω–∞ —Ç–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞**. Crash Celery ‚Üí —Ä–µ—Å—Ç–∞—Ä—Ç –≤—Å–µ–≥–æ | HIGH |
| INFRA-2 | **–ù–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Äî `numReplicas: 1` | MEDIUM |
| INFRA-3 | **–ù–µ—Ç staging –æ–∫—Ä—É–∂–µ–Ω–∏—è** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π | MEDIUM |
| INFRA-4 | **–ù–µ—Ç CI/CD** ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `.github/workflows/` | ‚úÖ GitHub Actions (lint, test, frontend-lint) |
| INFRA-5 | **–ù–µ—Ç CDN** –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ | LOW |
| INFRA-6 | In-memory state —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ (sessions, games, scenarios) | ‚úÖ –í—Å—ë –≤ Redis —Å TTL |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. ‚¨ú –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ 3 —Å–µ—Ä–≤–∏—Å–∞: backend, bot, celery (Railway compartments)
2. ‚úÖ GitHub Actions: lint + test –Ω–∞ PR (`.github/workflows/ci.yml`)
3. ‚úÖ –°–µ—Å—Å–∏–∏, –∏–≥—Ä—ã, —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ Redis (TTL: 30d/30min/1hr)
4. ‚úÖ Sentry SDK –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω (`sentry-sdk[fastapi]` + lifespan init)

---

## 11. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: **~30-35%** (–±—ã–ª–æ ~15-20%)

| –¢–µ—Å—Ç—ã –µ—Å—Ç—å | –¢–µ—Å—Ç–æ–≤ –Ω–µ—Ç |
|---|---|
| `test_endpoints.py` | `pronunciation_analyzer.py` |
| `test_repositories.py` | `translation_service.py` |
| `test_caching.py` | Telegram bot handlers |
| `test_correction_engine.py` | Frontend (0 —Ç–µ—Å—Ç–æ–≤) |
| `test_gamification.py` | E2E pipeline |
| Load test (Locust) | |
| ‚úÖ `test_auth.py` (—Å–µ—Å—Å–∏–∏/Redis) | |
| ‚úÖ `test_game_service.py` (–∏–≥—Ä—ã/Redis) | |
| ‚úÖ `test_scenario_service.py` (—Å—Ü–µ–Ω–∞—Ä–∏–∏/Redis) | |
| ‚úÖ `test_challenge_service.py` (RNG) | |
| ‚úÖ `test_honzik_personality.py` (prompt cache) | |
| ‚úÖ `test_grammar_repository.py` (joinedload) | |
| ‚úÖ `test_redis_client.py` (binary pool) | |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏: gamification (race conditions), SR algorithm, grammar selection
2. –î–æ–±–∞–≤–∏—Ç—å integration —Ç–µ—Å—Ç—ã –¥–ª—è auth flow
3. Frontend: —Ö–æ—Ç—è –±—ã smoke —Ç–µ—Å—Ç—ã —Å Playwright –¥–ª—è login ‚Üí practice ‚Üí response
4. –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –≤ CI/CD (`pytest.ini` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

---

## 12. UX/UI –ø—Ä–æ–±–ª–µ–º—ã

### –°–º–µ—à–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤
| –°—Ç—Ä–∞–Ω–∏—Ü–∞ | –Ø–∑—ã–∫–∏ |
|---|---|
| Practice | –ß–µ—à—Å–∫–∏–π + –ê–Ω–≥–ª–∏–π—Å–∫–∏–π + –†—É—Å—Å–∫–∏–π |
| Profile | –ê–Ω–≥–ª–∏–π—Å–∫–∏–π |
| Settings | –ß–µ—à—Å–∫–∏–π |
| Learn | –ß–µ—à—Å–∫–∏–π + –ê–Ω–≥–ª–∏–π—Å–∫–∏–π |
| Login | –ê–Ω–≥–ª–∏–π—Å–∫–∏–π |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–Ω–µ–¥—Ä–∏—Ç—å `next-intl` –∏–ª–∏ –¥—Ä—É–≥—É—é i18n –±–∏–±–ª–∏–æ—Ç–µ–∫—É. –ú–∏–Ω–∏–º—É–º ‚Äî –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –µ–¥–∏–Ω–æ–º—É —è–∑—ã–∫—É (—á–µ—à—Å–∫–∏–π –¥–ª—è UI, native_language –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π).

### –ü—Ä–æ–±–ª–µ–º—ã UX
| # | –ü—Ä–æ–±–ª–µ–º–∞ |
|---|---|
| UX-1 | –ù–µ—Ç `<html lang="cs">` ‚Äî –∑–∞—à–∏—Ç–æ –∫–∞–∫ `en` | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ `lang="cs"` |
| UX-2 | –ù–µ—Ç error boundary ‚Äî –æ—à–∏–±–∫–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∫—Ä–∞—à–∏—Ç –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | ‚úÖ `ErrorBoundary.tsx` + –æ–±—ë—Ä—Ç–∫–∞ dashboard |
| UX-3 | –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è |
| UX-4 | –î–ª–∏–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã Honzik –Ω–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ WebApp URL (–ª–∏–º–∏—Ç ~2048 —Å–∏–º–≤–æ–ª–æ–≤) |
| UX-5 | –ë–µ—Å–µ–¥–∞ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (state –≤ useState, –Ω–µ persisted) |
| UX-6 | Stats –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω—É–ª–∏ |
| UX-7 | Accessibility: –Ω–æ–ª—å ARIA-–∞—Ç—Ä–∏–±—É—Ç–æ–≤, –Ω–µ—Ç keyboard navigation –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ –∫–Ω–æ–ø–æ–∫ | ‚úÖ ARIA labels –Ω–∞ nav, main, links |
| UX-8 | –ù–µ—Ç offline-detection ‚Äî –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–µ—Ç–∏ –º—É—Ç–∞—Ü–∏–∏ –º–æ–ª—á–∞ –ø–∞–¥–∞—é—Ç |

---

## 13. –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: **$0 revenue**

**–í–µ—Å—å premium-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–∑–¥–∞—ë—Ç—Å—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ:**
- GPT-4o —Ä–∞–∑–≥–æ–≤–æ—Ä—ã (—Å—Ç–æ—è—Ç $0.03/—Å–æ–æ–±—â–µ–Ω–∏–µ)
- TTS –æ–∑–≤—É—á–∫–∞ ($0.015/—Å–æ–æ–±—â–µ–Ω–∏–µ)
- Whisper STT ($0.006/—Å–æ–æ–±—â–µ–Ω–∏–µ)
- 8 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å AI
- 5 —Ç–∏–ø–æ–≤ –º–∏–Ω–∏-–∏–≥—Ä
- Spaced repetition
- Pronunciation analyzer
- Exam prep, Story generator, Podcasts

### –ü–ª–∞–Ω –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

#### –§–∞–∑–∞ 1 ‚Äî –ù–µ–¥–µ–ª—è 1-2: –ù–∞—á–∞—Ç—å –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å
| –î–µ–π—Å—Ç–≤–∏–µ | –°—Ä–æ–∫ | –û–∂–∏–¥–∞–Ω–∏–µ |
|---|---|---|
| **–õ–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π** (5/–¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ) | 1-2 –¥–Ω—è | –°–æ–∑–¥–∞—ë—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ |
| **Telegram Stars** –æ–ø–ª–∞—Ç–∞ | 3-5 –¥–Ω–µ–π | $50-200/–º–µ—Å —Å –ø–µ—Ä–≤–æ–≥–æ –º–µ—Å—è—Ü–∞ |
| –ü–∞–∫–µ—Ç—ã: +10 –≥–æ–ª–æ—Å–æ–≤—ã—Ö (50‚≠ê), —Ç–µ–º–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è (100‚≠ê), 7 –¥–Ω–µ–π –±–µ–∑–ª–∏–º–∏—Ç (150‚≠ê) | | |

#### –§–∞–∑–∞ 2 ‚Äî –ù–µ–¥–µ–ª—è 3-6: –ü–æ–¥–ø–∏—Å–∫–∏
| –î–µ–π—Å—Ç–≤–∏–µ | –°—Ä–æ–∫ | –û–∂–∏–¥–∞–Ω–∏–µ |
|---|---|---|
| –ú–æ–¥–µ–ª—å `Subscription` + –º–∏–≥—Ä–∞—Ü–∏—è | 2 –¥–Ω—è | |
| Stripe Checkout –¥–ª—è –≤–µ–±–∞ | 5 –¥–Ω–µ–π | |
| **Free:** 5 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å, 1 –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π, –±–∞–∑–æ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | | |
| **Pro ($9.99/–º–µ—Å):** –ë–µ–∑–ª–∏–º–∏—Ç, –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, SR, –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | | $500-1500/–º–µ—Å |
| **Expert ($19.99/–º–µ—Å):** + Exam prep, Pronunciation, Podcasts, Stories | | $200-500/–º–µ—Å |

#### –§–∞–∑–∞ 3 ‚Äî –ú–µ—Å—è—Ü 2-3: –†–æ—Å—Ç
| –î–µ–π—Å—Ç–≤–∏–µ | –û–∂–∏–¥–∞–Ω–∏–µ |
|---|---|
| –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (–ø—Ä–∏–≥–ª–∞—Å–∏ ‚Üí 7 –¥–Ω–µ–π Pro) | +30% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ pricing | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ |
| –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å—Å–∫–∏–π/—Å–ª–æ–≤–∞—Ü–∫–∏–π —è–∑—ã–∫–∏ | –ù–æ–≤—ã–µ —Ä—ã–Ω–∫–∏ |

### –ü—Ä–æ–≥–Ω–æ–∑ –¥–æ—Ö–æ–¥–∞ (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π)
| –ú–µ—Ç—Ä–∏–∫–∞ | –ú–µ—Å—è—Ü 1 | –ú–µ—Å—è—Ü 3 | –ú–µ—Å—è—Ü 6 |
|---|---|---|---|
| –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | 500 | 2,000 | 5,000 |
| –ö–æ–Ω–≤–µ—Ä—Å–∏—è | 3% | 5% | 7% |
| –ü–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | 15 | 100 | 350 |
| MRR (–ø–æ–¥–ø–∏—Å–∫–∏) | $150 | $1,000 | $3,500 |
| Telegram Stars | $50 | $300 | $800 |
| **–ò—Ç–æ–≥–æ MRR** | **$200** | **$1,300** | **$4,300** |

### –ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥
> **–ü—Ä–æ–¥—É–∫—Ç feature-complete, –Ω–æ —Ä–∞–∑–¥–∞—ë—Ç AI-—Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é $10-20/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–º–µ—Å—è—Ü –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç #1 ‚Äî –ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π + –æ–ø–ª–∞—Ç–∞, –∞ –Ω–µ –Ω–æ–≤—ã–µ —Ñ–∏—á–∏.**

---

## 14. –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### üî¥ –°–µ–π—á–∞—Å (1-3 –¥–Ω—è) ‚Äî ‚úÖ –í–°–Å –í–´–ü–û–õ–ù–ï–ù–û
1. ‚úÖ **–†–æ—Ç–∏—Ä–æ–≤–∞—Ç—å Bot Token** ‚Äî –¥–µ—Ñ–æ–ª—Ç —É–¥–∞–ª—ë–Ω –∏–∑ –∫–æ–¥–∞ (—Ä–æ—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ BotFather ‚Äî —Ä—É—á–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ)
2. ‚úÖ **–§–∏–∫—Å BUG-1:** —Å–æ—Ö—Ä–∞–Ω—è—Ç—å token –ø—Ä–∏ WebApp login
3. ‚úÖ **–§–∏–∫—Å BUG-2:** null-safe –¥–ª—è `user.settings`
4. ‚úÖ **–§–∏–∫—Å BUG-3:** –¥–æ–±–∞–≤–∏—Ç—å `native_language` –≤ –∫–ª—é—á –∫—ç—à–∞ Honzik
5. ‚úÖ **–§–∏–∫—Å BUG-5:** –∏—Å–ø—Ä–∞–≤–∏—Ç—å kwarg `ui_language` ‚Üí `native_language` –≤ `web_lessons.py`
6. ‚úÖ –£–±—Ä–∞—Ç—å hardcoded admin secret ‚Üí –≤ env var –±–µ–∑ fallback + –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ Header

### üü° –ù–µ–¥–µ–ª—è 1-2
7. ‚¨ú –î–æ–±–∞–≤–∏—Ç—å –ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π (5/–¥–µ–Ω—å)
8. ‚¨ú –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Telegram Stars payments
9. ‚úÖ –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ sessions ‚Üí Redis (–ø–æ–ª–Ω–æ—Å—Ç—å—é –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ: `session:{token}` TTL=30d)
10. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å API authentication middleware (`get_authenticated_user` dependency)
11. ‚úÖ –§–∏–∫—Å `random.seed()` ‚Üí `random.Random(hash(...))` (thread-safe)

### üü¢ –ù–µ–¥–µ–ª—è 3-6
12. ‚¨ú –ú–æ–¥–µ–ª—å `Subscription` + Stripe integration
13. ‚¨ú Gate premium features (—Å—Ü–µ–Ω–∞—Ä–∏–∏, SR, pronunciation)
14. ‚úÖ CI/CD: GitHub Actions (`.github/workflows/ci.yml` ‚Äî lint, test, frontend-lint)
15. ‚¨ú –†–∞–∑–¥–µ–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ 3 —Å–µ—Ä–≤–∏—Å–∞
16. ‚úÖ Error boundary –≤–æ frontend (`ErrorBoundary.tsx` + –æ–±—ë—Ä—Ç–∫–∞ dashboard)
17. ‚úÖ `<html lang="cs">` (–±—ã–ª–æ `en`) + ARIA labels –Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—é

### üìã –ë—ç–∫–ª–æ–≥
18. ‚úÖ –§–∏–∫—Å N+1 queries (grammar progress ‚Äî `joinedload`, weak_rules ‚Äî `joinedload`)
19. ‚úÖ Redis –¥–ª—è sessions/games/scenarios (–ø–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å TTL)
20. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã: 7 –Ω–æ–≤—ã—Ö test files (~30%+ coverage)
21. ‚úÖ Accessibility: ARIA labels –Ω–∞ nav, main, links (`aria-label`, `role`, `aria-current`)
22. ‚úÖ Sentry monitoring (`sentry-sdk[fastapi]` + lifespan init)
23. ‚úÖ In-memory state (games, scenarios) –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ Redis (`game:active:{uid}`, `scenario:active:{uid}`)
24. ‚úÖ OpenAI: `@lru_cache` –Ω–∞ system prompt, dead code —É–¥–∞–ª—ë–Ω (MODEL_PRICING, TOKEN_LIMITS, get_optimal_model), –ø—É—Å—Ç–∞—è –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è

### üü£ –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π + –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Honz√≠ka (20 —Ñ–µ–≤—Ä–∞–ª—è 2026)
25. ‚úÖ **–ù–æ–≤—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂: pan√≠ Nov√°kov√°** ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É—Ä—ë–¥–Ω–∏—Ü–∞, –≤—ã–∫–∞–Ω–∏–µ, spisovn√° ƒçe≈°tina, –ø–æ–º–æ—â—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏/—É—Ä—è–¥–∞–º–∏
    - `honzik_personality.py` —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `character`
    - DB: —Å—Ç–æ–ª–±–µ—Ü `character` –≤ `user_settings` (migration `20260220_add_character`)
    - Schema: `UserSettingsUpdate` / `UserSettingsResponse` + `character` field
    - TTS: `honzik` ‚Üí `alloy` (male), `novakova` ‚Üí `nova` (female)
    - Frontend: –≤—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ Nastaven√≠ ‚Üí tab Uƒçen√≠
26. ‚úÖ **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ Honz√≠ka** ‚Äî –≤–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ –ø–∏–≤–∞/–∫–æ–ª–±–∞—Å–æ–∫ —Ç–µ–ø–µ—Ä—å:
    - üè† –ü—Ä–∞–≥–∞ –∏ —á–µ—à—Å–∫–∏–µ –≥–æ—Ä–æ–¥–∞, üé≠ –∫—É–ª—å—Ç—É—Ä–∞ –∏ –º—É–∑—ã–∫–∞, ‚öΩ —Å–ø–æ—Ä—Ç, üåç –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, üíº —Ä–∞–±–æ—Ç–∞, üöá —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, üõù –±—ã—Ç
27. ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤:**
    - –£–¥–∞–ª—ë–Ω `optimize_conversation_history` (—ç–∫–æ–Ω–æ–º–∏—è ~100-200ms/–∑–∞–ø—Ä–æ—Å)
    - –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã (~350 tokens –≤–º–µ—Å—Ç–æ ~600) ‚Üí –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ ~0.5-1s
    - `lru_cache(maxsize=128)` (–±—ã–ª–æ 64) –¥–ª—è 2 –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
    - `web_lessons.py`: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω OpenAI singleton (–±—ã–ª–æ `OpenAIClient()` –±–µ–∑ settings)
    - –†–∞—Å—à–∏—Ä–µ–Ω–∞ –∫–∞—Ä—Ç–∞ `native_lang_names` –Ω–∞ 40+ —è–∑—ã–∫–æ–≤
    - `character` –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–ª—é—á –∫—ç—à–∞ (–Ω–µ—Ç cross-contamination –º–µ–∂–¥—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏)
