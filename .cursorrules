# === –ú–ï–¢–ê–î–ê–ù–ù–´–ï –ü–†–û–ï–ö–¢–ê ===
–Ω–∞–∑–≤–∞–Ω–∏–µ: Mluv.Me - Language Tutor Bot
–æ–ø–∏—Å–∞–Ω–∏–µ: Telegram-–±–æ—Ç –∏ WebApp –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–≥–æ —á–µ—à—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —á–µ—Ä–µ–∑ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å AI-—Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–æ–º
—è–∑—ã–∫: Python
–≤–µ—Ä—Å–∏—è: 1.0.0
–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è_–≤–µ—Ä—Å–∏—è_python: 3.11

# === –¢–ï–•–ù–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –°–¢–ï–ö ===

## Backend
framework: FastAPI
orm: SQLAlchemy 2.0+ / SQLModel
–º–∏–≥—Ä–∞—Ü–∏–∏: Alembic
–≤–∞–ª–∏–¥–∞—Ü–∏—è: Pydantic 2.9+
–±–∞–∑–∞_–¥–∞–Ω–Ω—ã—Ö: PostgreSQL
–∫–µ—à: Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## Telegram Bot
bot_framework: aiogram 3.x
–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ–Ω–∫–∏–µ handlers, –≤—Å—è –ª–æ–≥–∏–∫–∞ –≤ backend

## AI/ML –°–µ—Ä–≤–∏—Å—ã
llm: OpenAI GPT-4o / GPT-4.1
stt: OpenAI Whisper
tts: OpenAI TTS
–≥–æ–ª–æ—Å–∞: alex, emily, –∏ –¥—Ä—É–≥–∏–µ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ)

## WebApp
framework: Next.js 14+ (App Router)
—è–∑—ã–∫: TypeScript
—Å—Ç–∏–ª—å: Tailwind CSS / CSS Modules
ui: React Server Components + Client Components
–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: Telegram WebApp initData —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ backend

## –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è: Docker + docker-compose
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: structlog –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, Sentry –¥–ª—è –æ—à–∏–±–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: pytest —Å pytest-asyncio
–ª–∏–Ω—Ç–∏–Ω–≥: ruff –¥–ª—è Python, ESLint –¥–ª—è TypeScript
—Ç–∏–ø–∏–∑–∞—Ü–∏—è: mypy –¥–ª—è Python, TypeScript strict mode

# === –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê ===

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```
language-tutor-bot/
‚îú‚îÄ‚îÄ backend/              # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ main.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py        # Pydantic Settings
‚îÇ   ‚îú‚îÄ‚îÄ routers/         # HTTP endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py      # –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram WebApp initData
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py     # CRUD –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lesson.py    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö (STT‚ÜíLLM‚ÜíTTS)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stats.py     # Streak, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø—Ä–æ–≥—Ä–µ—Å—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ words.py     # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞, –∫–∞—Ä—Ç–æ—á–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ topics.py    # –¢–µ–º—ã, –∫–≤–µ—Å—Ç—ã, —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ openai_client.py      # –û–±—ë—Ä—Ç–∫–∞ OpenAI API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ speech_analyzer.py    # –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ correction_engine.py  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gamification.py       # –ó–≤—ë–∑–¥—ã, –∞—á–∏–≤–∫–∏, streak
‚îÇ   ‚îú‚îÄ‚îÄ models/          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ message.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ word.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stats.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/         # Pydantic —Å—Ö–µ–º—ã –¥–ª—è API
‚îÇ   ‚îú‚îÄ‚îÄ db/              # Database utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py  # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, —Å–µ—Å—Å–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories.py  # Repository pattern
‚îÇ   ‚îî‚îÄ‚îÄ utils/           # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ bot/                 # Telegram –±–æ—Ç (aiogram)
‚îÇ   ‚îú‚îÄ‚îÄ main.py         # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ handlers/       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start.py    # /start, –ø–µ—Ä–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ voice.py    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands.py # /help, /stats, /saved, /reset
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings.py # /voice, /level, /voice_speed, /topics
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/      # Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ services/       # –ö–ª–∏–µ–Ω—Ç—ã –∫ backend
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api_client.py
‚îÇ   ‚îî‚îÄ‚îÄ config.py       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ webapp/             # Next.js Telegram WebApp
‚îÇ   ‚îú‚îÄ‚îÄ app/           # App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx          # –ü—Ä–æ—Ñ–∏–ª—å (streak, –ø—Ä–æ–≥—Ä–µ—Å—Å)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ saved/page.tsx    # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stars/page.tsx    # –ó–≤—ë–∑–¥—ã, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings/page.tsx # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ components/    # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ lib/          # –£—Ç–∏–ª–∏—Ç—ã, API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ public/       # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã
‚îÇ
‚îú‚îÄ‚îÄ infra/            # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–±—É–¥—É—â–µ–µ)
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îî‚îÄ‚îÄ migrations/   # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ docs/             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ api.md
‚îÇ   ‚îî‚îÄ‚îÄ architecture.md
‚îÇ
‚îî‚îÄ‚îÄ .cursorrules      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏ (Clean Architecture)

### Backend
1. **Presentation Layer** (routers/) - HTTP endpoints, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
2. **Business Logic Layer** (services/) - –í—Å—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. **Data Access Layer** (repositories/) - –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
4. **Infrastructure Layer** (db/, utils/) - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Bot
- **Handlers** - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞, —Ç–æ–ª—å–∫–æ –ø—Ä–∏–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞
- **Services** - HTTP –∫–ª–∏–µ–Ω—Ç –∫ backend API
- –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ backend!

### WebApp
- **Pages** - Server Components –¥–ª—è SEO –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **Components** - –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **Lib** - API –∫–ª–∏–µ–Ω—Ç, —É—Ç–∏–ª–∏—Ç—ã, —Ö—É–∫–∏

# === –û–°–ù–û–í–ù–´–ï –ü–†–ò–ù–¶–ò–ü–´ ===

–ø—Ä–∞–≤–∏–ª–∞:
  - –¢—ã senior Python/TypeScript —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–æ–π –≤ AI –∏ Telegram –±–æ—Ç–∞—Ö
  - –¢—ã senior UX/UI —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏ –ø–æ–Ω–∏–º–∞–µ—à—å –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤–µ–±-–¥–∏–∑–∞–π–Ω–∞
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å async/await –¥–ª—è –≤—Å–µ—Ö I/O –æ–ø–µ—Ä–∞—Ü–∏–π
  - –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å type hints (Python) / —Ç–∏–ø—ã (TypeScript)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Pydantic –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
  - –°–ª–µ–¥–æ–≤–∞—Ç—å Clean Architecture - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏
  - –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ–Ω–∫–∏–º - –≤—Å—è –ª–æ–≥–∏–∫–∞ –≤ backend
  - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  - Graceful error handling —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  - –¢–µ—Å—Ç—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
  - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ docstrings (Google style –¥–ª—è Python, JSDoc –¥–ª—è TypeScript)
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ (—Ä—É—Å—Å–∫–∏–π, —á–µ—à—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)

# === –ü–ê–¢–¢–ï–†–ù–´ –ü–†–û–ï–ö–¢–ò–†–û–í–ê–ù–ò–Ø ===

## Backend Patterns
- **Repository Pattern** - –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- **Service Layer Pattern** - –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- **Dependency Injection** - –ß–µ—Ä–µ–∑ FastAPI Depends
- **Factory Pattern** - –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ (OpenAI, –∏ —Ç.–¥.)
- **Strategy Pattern** - –î–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ –æ–±—É—á–µ–Ω–∏—è (tutor, listener, psychologist)

## Frontend Patterns
- **Server Components First** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RSC –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- **Client Components** - –¢–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **Custom Hooks** - –î–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ª–æ–≥–∏–∫–∏
- **Compound Components** - –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤

# === –°–¢–ò–õ–¨ –ö–û–î–ê ===

## Python (Backend + Bot)
- PEP8 —Å—Ç–∞–Ω–¥–∞—Ä—Ç
- –î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏: 100 —Å–∏–º–≤–æ–ª–æ–≤
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ç–∏–ø–æ–≤: `list[str]` –≤–º–µ—Å—Ç–æ `List[str]`
- `Optional[T]` –∏–ª–∏ `T | None` –¥–ª—è nullable
- Async —Ñ—É–Ω–∫—Ü–∏–∏ —Å —è–≤–Ω—ã–º `async def`
- Google-style docstrings

## TypeScript (WebApp)
- Strict mode –≤–∫–ª—é—á–µ–Ω
- Functional components —Å TypeScript
- –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ default
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `const` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- Destructuring –¥–ª—è props

## –°–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏

### Python
- –ö–ª–∞—Å—Å—ã: `PascalCase` (UserRepository, OpenAIClient)
- –§—É–Ω–∫—Ü–∏–∏/–º–µ—Ç–æ–¥—ã: `snake_case` (get_user_stats, process_voice_message)
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã: `UPPER_SNAKE_CASE` (MAX_VOICE_DURATION, DEFAULT_LEVEL)
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ: `_leading_underscore` (_validate_audio, _calculate_score)

### TypeScript
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: `PascalCase` (ProfilePage, StreakCalendar)
- –§—É–Ω–∫—Ü–∏–∏: `camelCase` (getUserStats, processMessage)
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã: `UPPER_SNAKE_CASE` (API_BASE_URL, MAX_RETRIES)
- –¢–∏–ø—ã/–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã: `PascalCase` (User, MessageResponse)

# === –°–•–ï–ú–ê –ë–ê–ó–´ –î–ê–ù–ù–´–• ===

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### users
- id (PK)
- telegram_id (unique, indexed)
- username
- first_name
- native_language (ru, uk, en)
- target_language (cs, en, de)
- level (beginner|intermediate|advanced|native)
- created_at
- updated_at

### user_settings
- id (PK)
- user_id (FK ‚Üí users)
- mode (chatty|elon_musk|listener|psychologist|translator|custom)
- voice (alex|eric|henry|james|chatty|emily|turn_off)
- voice_speed (very_slow|slow|normal|native)
- topics (JSONB: —Å–ø–∏—Å–æ–∫ id —Ç–µ–º)
- timezone
- notifications_enabled (bool)

### messages
- id (PK)
- user_id (FK ‚Üí users)
- role (user|assistant)
- text (—Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è)
- transcript_raw (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è STT)
- transcript_normalized (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç)
- audio_file_path (–ø—É—Ç—å –∫ –∞—É–¥–∏–æ —Ñ–∞–π–ª—É)
- correctness_score (0-100)
- words_total (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤)
- words_correct (–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Å–ª–æ–≤)
- created_at

### saved_words
- id (PK)
- user_id (FK ‚Üí users)
- word (—Å–ª–æ–≤–æ)
- translation (–ø–µ—Ä–µ–≤–æ–¥)
- context_sentence (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ-–∫–æ–Ω—Ç–µ–∫—Å—Ç)
- phonetics (—Ñ–æ–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è)
- times_reviewed (—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–≤—Ç–æ—Ä—è–ª–æ—Å—å)
- created_at
- last_reviewed_at

### daily_stats
- id (PK)
- user_id (FK ‚Üí users)
- date (–¥–∞—Ç–∞)
- messages_count (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π)
- words_said (—Å–ª–æ–≤ —Å–∫–∞–∑–∞–Ω–æ)
- correct_percent (–ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö)
- streak_day (–¥–µ–Ω—å streak –ø–æ–¥—Ä—è–¥)

### stars
- id (PK)
- user_id (FK ‚Üí users)
- total (–≤—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ)
- available (–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –æ–±–º–µ–Ω–∞)
- lifetime (–∑–∞ –≤—Å–µ –≤—Ä–µ–º—è)
- updated_at

### subscriptions (–Ω–∞ –±—É–¥—É—â–µ–µ)
- id (PK)
- user_id (FK ‚Üí users)
- plan (free|monthly|yearly)
- status (active|cancelled|expired)
- started_at
- expires_at
- provider (telegram_stars|stripe|manual)

### topics (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
- id (PK)
- name (–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã)
- description
- is_active

## –ò–Ω–¥–µ–∫—Å—ã
- users.telegram_id (unique)
- messages.user_id, messages.created_at (composite)
- saved_words.user_id, saved_words.word (composite)
- daily_stats.user_id, daily_stats.date (composite, unique)

# === API ENDPOINTS (Backend) ===

## Authentication
POST /api/v1/auth/validate - –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram WebApp initData

## Users
GET /api/v1/users/me - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
PATCH /api/v1/users/me - –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
GET /api/v1/users/me/settings - –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
PATCH /api/v1/users/me/settings - –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## Lessons (–≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è)
POST /api/v1/lessons/process - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: audio file (multipart/form-data)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: transcript, corrections, audio_response, score

## Statistics
GET /api/v1/stats/streak - –ü–æ–ª—É—á–∏—Ç—å streak –∫–∞–ª–µ–Ω–¥–∞—Ä—å
GET /api/v1/stats/summary - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (words said, correct %, –∏ —Ç.–¥.)
GET /api/v1/stats/daily?from=YYYY-MM-DD&to=YYYY-MM-DD - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è–º

## Words
GET /api/v1/words - –°–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
POST /api/v1/words - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ª–æ–≤–æ
DELETE /api/v1/words/{word_id} - –£–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ
PATCH /api/v1/words/{word_id}/review - –û—Ç–º–µ—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ

## Topics
GET /api/v1/topics - –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–µ–º
GET /api/v1/topics/{topic_id} - –î–µ—Ç–∞–ª–∏ —Ç–µ–º—ã

## Stars
GET /api/v1/stars - –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –∑–≤–µ–∑–¥
POST /api/v1/stars/earn - –ù–∞—á–∏—Å–ª–∏—Ç—å –∑–≤–µ–∑–¥—ã (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π endpoint)

# === –û–ë–†–ê–ë–û–¢–ö–ê –ì–û–õ–û–°–û–í–´–• –°–û–û–ë–©–ï–ù–ò–ô ===

## –ü—Ä–æ—Ü–µ—Å—Å (POST /api/v1/lessons/process)

1. **–ü—Ä–∏–µ–º –∞—É–¥–∏–æ**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (ogg, mp3, wav)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º–∞–∫—Å 60 —Å–µ–∫—É–Ω–¥ –¥–ª—è MVP)
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞

2. **Speech-to-Text (Whisper)**
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ OpenAI Whisper API
   - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ raw transcript

3. **–ê–Ω–∞–ª–∏–∑ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (GPT)**
   - –ü—Ä–æ–º–ø—Ç —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:
     * –£—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
     * –¶–µ–ª–µ–≤–æ–π —è–∑—ã–∫
     * –†–µ–∂–∏–º (tutor/listener/psychologist)
     * –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - LLM –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
     * –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
     * –°–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏
     * –û—Ü–µ–Ω–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ (0-100)
     * –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

4. **Text-to-Speech (OpenAI TTS)**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ–ª–æ—Å–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏
   - –í–æ–∑–≤—Ä–∞—Ç audio file

5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥

## –ü—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

#### üá¨üáß Chatty (–æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–∂–∏–º - Tutor)
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏ –∏ –æ–±—ä—è—Å–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞.

**–ü—Ä–æ–º–ø—Ç**:
```
You are a {target_language} language tutor for a {level} student.
Their native language is {native_language}.

Analyze the following transcription and:
1. Identify grammar and pronunciation mistakes
2. Provide corrections with explanations in {native_language}
3. Rate correctness from 0-100
4. Give a natural response to continue the conversation

Transcription: {user_text}

Respond in JSON format:
{
  "corrected_text": "...",
  "mistakes": [{"original": "...", "corrected": "...", "explanation": "..."}],
  "correctness_score": 85,
  "response_text": "..."
}
```

#### üöÄ Elon Musk (–ø–µ—Ä—Å–æ–Ω–∞–∂)
**–û–ø–∏—Å–∞–Ω–∏–µ**: –†–∞–∑–≥–æ–≤–æ—Ä —Å AI –≤ —Ä–æ–ª–∏ –ò–ª–æ–Ω–∞ –ú–∞—Å–∫–∞ - –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π, –±–∏–∑–Ω–µ—Å–∞, –∫–æ—Å–º–æ—Å–∞.

**–ü—Ä–æ–º–ø—Ç**:
```
You are Elon Musk speaking {target_language}.
You're talking to a {level} student whose native language is {native_language}.

Respond as Elon would - enthusiastic about technology, space, and innovation.
Gently correct language mistakes while staying in character.
Keep responses concise and engaging.

Transcription: {user_text}
```

#### üéß Listener (–¥—Ä—É–≥)
**–û–ø–∏—Å–∞–Ω–∏–µ**: –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ú–∏–Ω–∏–º—É–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏)
- –§–æ–∫—É—Å –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- –ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ç–æ–Ω
- –ó–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–∏–∞–ª–æ–≥

**–ü—Ä–æ–º–ø—Ç**:
```
You are a friendly conversation partner speaking {target_language}.
Your goal is to keep the conversation flowing naturally.
Only correct critical mistakes that impede understanding.
Ask follow-up questions to encourage the student to speak more.

Student level: {level}
Native language: {native_language}

Transcription: {user_text}
```

#### üß† Psychologist (–ø—Å–∏—Ö–æ–ª–æ–≥)
**–û–ø–∏—Å–∞–Ω–∏–µ**: –≠–º–ø–∞—Ç–∏—á–Ω—ã–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —ç–º–æ—Ü–∏–π –∏ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–π.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –≠–º–ø–∞—Ç–∏—á–Ω—ã–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ –æ—Ç–≤–µ—Ç—ã
- –ü–æ–º–æ—â—å –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ —ç–º–æ—Ü–∏–π –Ω–∞ —Ü–µ–ª–µ–≤–æ–º —è–∑—ã–∫–µ
- –î–µ–ª–∏–∫–∞—Ç–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–ª—É—à–∞–Ω–∏–µ

**–ü—Ä–æ–º–ø—Ç**:
```
You are an empathetic psychologist speaking {target_language}.
Help the student express their emotions and thoughts.
Provide gentle language corrections without interrupting the emotional flow.
Show understanding and ask reflective questions.

Student level: {level}
Native language: {native_language}

Transcription: {user_text}
```

#### üåç Translator (–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫)
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–º–æ—â—å —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –Ω—é–∞–Ω—Å–æ–≤ —è–∑—ã–∫–∞.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –¢–æ—á–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏–¥–∏–æ–º –∏ —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞
- –ö—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

**–ü—Ä–æ–º–ø—Ç**:
```
You are a professional translator between {native_language} and {target_language}.
Provide accurate translations and explain nuances.
Offer alternative translations when applicable.
Explain idioms and cultural context.

Student level: {level}

Transcription: {user_text}
```

#### üë§ Custom Mode (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º)
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∂–µ–ª–∞–µ–º–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- –°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø–∏—Å–∞–Ω–∏—è
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ user_settings.custom_mode_prompt

# === –ì–ï–ô–ú–ò–§–ò–ö–ê–¶–ò–Ø ===

## –°–∏—Å—Ç–µ–º–∞ –∑–≤–µ–∑–¥

### –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥
- 1 –∑–≤–µ–∑–¥–∞ –∑–∞ –∫–∞–∂–¥–æ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ë–æ–Ω—É—Å +1 –∑–∞ correctness_score > 80%
- –ë–æ–Ω—É—Å +2 –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ streak 7 –¥–Ω–µ–π
- –ë–æ–Ω—É—Å +5 –∑–∞ streak 30 –¥–Ω–µ–π

### Daily Stars Challenge
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å 10 –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –¥–µ–Ω—å
- –ù–∞–≥—Ä–∞–¥–∞: 10 –∑–≤–µ–∑–¥

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–≤–µ–∑–¥ (V2)
- –û–±–º–µ–Ω –Ω–∞ –ø–æ–¥–∞—Ä–∫–∏
- –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–µ–º–∏—É–º —Ç–µ–º
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏

## Streak —Å–∏—Å—Ç–µ–º–∞

### –ü—Ä–∞–≤–∏–ª–∞
- Streak —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –º–∏–Ω–∏–º—É–º 1 —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¥–µ–Ω—å
- Streak —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–ø—É—Å–∫–µ –¥–Ω—è
- Timezone —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –¥–Ω–µ–π
- –¢–µ–∫—É—â–∏–π streak (üî• –∏–∫–æ–Ω–∫–∞)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π streak

# === TELEGRAM BOT (aiogram) ===

## –ö–æ–º–∞–Ω–¥—ã

### /start
- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—ã–±–æ—Ä —Ä–æ–¥–Ω–æ–≥–æ —è–∑—ã–∫–∞
- –í—ã–±–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ —è–∑—ã–∫–∞
- –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î —á–µ—Ä–µ–∑ backend API

### /help
**Commands:**
- `/unlimited` - Manage unlimited subscription
- `/voice` - Change Chatty's voice or turn off voice responses
- `/level` - Change your English level for simpler or more complex responses
- `/topics` - Choose a topic for discussion
- `/saved` - View your saved words
- `/voice_speed` - Change Chatty voice messages speed
- `/stats` - Show your usage statistics of Chatty
- `/languages` - Chatty bots for other languages
- `/reset` - Start a new conversation. All previous messages will be permanently deleted from the database and will only remain in your history.

**–°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:**
- üé§ Use Voice messages instead of text
- ü§î Don't hesitate to ask any questions. New phrases, word translations, grammar rules, etc.
- üó£Ô∏è Talk a lot. Your goal is to respond very detailed and use complex sentences.
- ‚ù§Ô∏è Ask to change the topic if you want - don't be afraid to offend Chatty.

### /stats
- –ë—ã—Å—Ç—Ä–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (streak, words said, correct %)
- –ö–Ω–æ–ø–∫–∞ "Open WebApp" –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### /saved
- –°–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
- –ö–Ω–æ–ø–∫–∞ "Open WebApp" –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞

### /reset
- –ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä
- –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∏–∑ –ë–î
- –°–æ–æ–±—â–µ–Ω–∏—è –æ—Å—Ç–∞–Ω—É—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –∏—Å—Ç–æ—Ä–∏–∏ Telegram
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

### /unlimited
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–æ–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–ª–∞–Ω–µ
- –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É

### /languages
- –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —è–∑—ã–∫–æ–≤—ã—Ö –±–æ—Ç–æ–≤
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–æ–π —è–∑—ã–∫ –æ–±—É—á–µ–Ω–∏—è

### /settings
- –ë—ã—Å—Ç—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ inline –∫–Ω–æ–ø–∫–∏:
  * /level - –ò–∑–º–µ–Ω–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
  * /voice - –í—ã–±—Ä–∞—Ç—å –≥–æ–ª–æ—Å
  * /voice_speed - –°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏
  * /topics - –í—ã–±—Ä–∞—Ç—å —Ç–µ–º—ã
  * /mode - –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è
  * /invite - –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π
  * /premium - –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö

```python
@router.message(F.voice)
async def handle_voice(message: Message, api_client: APIClient):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è."""
    # 1. –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
    file = await bot.get_file(message.voice.file_id)
    audio_bytes = await bot.download_file(file.file_path)

    # 2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ backend
    response = await api_client.process_voice(
        user_id=message.from_user.id,
        audio=audio_bytes
    )

    # 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–π –æ—Ç–≤–µ—Ç
    await message.answer_voice(
        voice=response.audio_response,
        caption=response.corrections_text
    )

    # 4. Inline –∫–Ω–æ–ø–∫–∏: "Text" (–ø–æ–∫–∞–∑–∞—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é), "Help"
    await message.answer(
        "...",
        reply_markup=get_voice_response_keyboard()
    )
```

## Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

### –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è
```
[ Beginner ] [ Intermediate ]
[ Advanced ] [    Native    ]
```

### –í—ã–±–æ—Ä —Å–∫–æ—Ä–æ—Å—Ç–∏
```
[ Very Slow ] [ Slow ]
[  Normal   ] [ Native ]
```

### –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
```
[ üá¨üáß Chatty ‚úÖ ] [ üöÄ Elon Musk ]
[ üéß Listener  ] [ üß† Psychologist ]
[ üåç Translator ] [ üë§ Custom Mode ]
```

### –í—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞
```
[   Alex   ] [  Eric   ] [ Henry ]
[  James   ] [ Chatty ‚úÖ] [ Emily ]
[        Turn off        ]
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ–ª–æ—Å–∞:
- **Alex** - –ú—É–∂—Å–∫–æ–π, –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π –∞–∫—Ü–µ–Ω—Ç
- **Eric** - –ú—É–∂—Å–∫–æ–π, –±—Ä–∏—Ç–∞–Ω—Å–∫–∏–π –∞–∫—Ü–µ–Ω—Ç
- **Henry** - –ú—É–∂—Å–∫–æ–π, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π
- **James** - –ú—É–∂—Å–∫–æ–π, —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π
- **Chatty** - –ñ–µ–Ω—Å–∫–∏–π, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **Emily** - –ñ–µ–Ω—Å–∫–∏–π, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π
- **Turn off** - –û—Ç–∫–ª—é—á–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã

# === WEBAPP (Next.js) ===

## –°—Ç—Ä–∞–Ω–∏—Ü—ã

### / (Profile)
- Streak –∫–∞–ª–µ–Ω–¥–∞—Ä—å (—Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü)
- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
  * Words Said
  * Max Streak
  * Correct %
  * Messages Sent
- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≤–Ω–∏–∑—É: Profile | Saved | Stars | Settings

### /saved
- –°–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
- –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ: word, translation, context
- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è
- –ü–æ–∏—Å–∫ –ø–æ —Å–ª–æ–≤–∞–º

### /stars
- –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –∑–≤–µ–∑–¥
- "Exchange stars for gifts" (Coming soon)
- Daily Stars Challenge
  * –ü—Ä–æ–≥—Ä–µ—Å—Å (X/10 —Å–æ–æ–±—â–µ–Ω–∏–π)
  * –ù–∞–≥—Ä–∞–¥–∞: 10 –∑–≤–µ–∑–¥
- Boost stars with friends (—Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)

### /settings
**–ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏** (–≤–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫):
- üíù **Get unlimited access** - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø—Ä–µ–º–∏—É–º
  * –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
  * –í—Å–µ —Ä–µ–∂–∏–º—ã –∏ –≥–æ–ª–æ—Å–∞
  * –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
  * –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∞—Ä–∏—Ç—å 3 –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –Ω–µ–¥–µ–ª—å–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –º–µ—Å—è—Ü

- üë• **Invite friends** - –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
  * –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
  * –ë–æ–Ω—É—Å–Ω—ã–µ –∑–≤–µ–∑–¥—ã –∑–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω—ã—Ö –¥—Ä—É–∑–µ–π
  * –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π

- üéÅ **Gift subscription** - –ü–æ–¥–∞—Ä–æ—á–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
  * –ü–æ–¥–∞—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –¥—Ä—É–≥—É
  * –í—ã–±–æ—Ä –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω–µ–¥–µ–ª—è, –º–µ—Å—è—Ü, –≥–æ–¥)
  * –ò—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤

**–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** (—Å—Ä–µ–¥–Ω–∏–π –±–ª–æ–∫):
- üé≠ **Change mode** - –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è
  * üá¨üáß Chatty (–æ—Å–Ω–æ–≤–Ω–æ–π)
  * üöÄ Elon Musk
  * üéß Listener
  * üß† Psychologist
  * üåç Translator
  * üë§ Custom Mode

- üé§ **Change Chatty voice** - –í—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞
  * Alex, Eric, Henry, James (–º—É–∂—Å–∫–∏–µ)
  * Chatty, Emily (–∂–µ–Ω—Å–∫–∏–µ)
  * Turn off (–æ—Ç–∫–ª—é—á–∏—Ç—å)

- üìä **Change your English level** - –£—Ä–æ–≤–µ–Ω—å —è–∑—ã–∫–∞
  * Beginner
  * Intermediate
  * Advanced
  * Native

- ‚ö° **Change Chatty voice speed** - –°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏
  * Very Slow
  * Slow
  * Normal
  * Native

- üìö **Choose topics** - –í—ã–±–æ—Ä —Ç–µ–º –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ (50 topics available)
  * Travel and Culture
  * Food and Cooking
  * Music and Art
  * Sports and Fitness
  * Technology and Social Media
  * Work and Career
  * Hobbies and Interests
  * Daily Life
  * Health and Wellness
  * Education and Learning
  * Relationships and Family
  * Entertainment and Movies
  * Books and Literature
  * Nature and Environment
  * Fashion and Style
  * ... (–≤—Å–µ–≥–æ 50 —Ç–µ–º)

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ** (–Ω–∏–∂–Ω–∏–π –±–ª–æ–∫):
- ‚ùì **How to use Chatty** - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
  * –í–∏–¥–µ–æ-—Ç—É—Ç–æ—Ä–∏–∞–ª
  * –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
  * FAQ
  * –°–æ–≤–µ—Ç—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### StreakCalendar
```tsx
interface StreakCalendarProps {
  streakData: DailyStreak[];
  currentStreak: number;
  maxStreak: number;
}

export function StreakCalendar({ streakData, currentStreak, maxStreak }: StreakCalendarProps) {
  // –†–µ–Ω–¥–µ—Ä –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –¥–Ω–µ–π
  // –¢–µ–∫—É—â–∏–π –¥–µ–Ω—å - –æ—Ä–∞–Ω–∂–µ–≤–∞—è –æ–±–≤–æ–¥–∫–∞
  // –î–Ω–∏ —Å–æ streak - —Å–∏–Ω—è—è –∑–∞–ª–∏–≤–∫–∞
}
```

### StatCard
```tsx
interface StatCardProps {
  value: number | string;
  label: string;
  icon?: React.ReactNode;
}

export function StatCard({ value, label, icon }: StatCardProps) {
  // –ö–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
}
```

### SavedWordCard
```tsx
interface SavedWordCardProps {
  word: SavedWord;
  onDelete: (id: string) => void;
}

export function SavedWordCard({ word, onDelete }: SavedWordCardProps) {
  // –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞
}
```

## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram WebApp

### Frontend (webapp)
```typescript
// lib/telegram.ts
import { useEffect, useState } from 'react';

export function useTelegramWebApp() {
  const [webApp, setWebApp] = useState<any>(null);

  useEffect(() => {
    const app = (window as any).Telegram?.WebApp;
    if (app) {
      app.ready();
      setWebApp(app);
    }
  }, []);

  return webApp;
}

export function getInitData(): string {
  return (window as any).Telegram?.WebApp?.initData || '';
}
```

### Backend (FastAPI)
```python
# routers/auth.py
from fastapi import Header, HTTPException
import hmac
import hashlib

async def validate_telegram_init_data(
    authorization: str = Header(...)
) -> dict:
    """–í–∞–ª–∏–¥–∞—Ü–∏—è Telegram WebApp initData."""
    # 1. –ü–∞—Ä—Å–∏–Ω–≥ initData
    # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ HMAC-SHA256
    # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
    # 4. –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    pass
```

## –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è

### Telegram Theme Variables
```css
:root {
  --tg-theme-bg-color: #ffffff;
  --tg-theme-text-color: #000000;
  --tg-theme-hint-color: #999999;
  --tg-theme-link-color: #2481cc;
  --tg-theme-button-color: #2481cc;
  --tg-theme-button-text-color: #ffffff;
}

[data-theme="dark"] {
  --tg-theme-bg-color: #212121;
  --tg-theme-text-color: #ffffff;
  /* ... */
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```tsx
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ç–µ–º–µ Telegram
<div className="bg-[var(--tg-theme-bg-color)] text-[var(--tg-theme-text-color)]">
  {/* content */}
</div>
```

# === –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï ===

## Backend (pytest)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤
```
tests/
‚îú‚îÄ‚îÄ conftest.py          # Fixtures
‚îú‚îÄ‚îÄ test_services/
‚îÇ   ‚îú‚îÄ‚îÄ test_openai_client.py
‚îÇ   ‚îú‚îÄ‚îÄ test_correction_engine.py
‚îÇ   ‚îî‚îÄ‚îÄ test_gamification.py
‚îú‚îÄ‚îÄ test_routers/
‚îÇ   ‚îú‚îÄ‚îÄ test_auth.py
‚îÇ   ‚îú‚îÄ‚îÄ test_lessons.py
‚îÇ   ‚îî‚îÄ‚îÄ test_stats.py
‚îî‚îÄ‚îÄ test_repositories/
    ‚îú‚îÄ‚îÄ test_user_repository.py
    ‚îî‚îÄ‚îÄ test_message_repository.py
```

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤
```python
# test_services/test_gamification.py
import pytest
from services.gamification import calculate_stars

def test_calculate_stars_basic():
    """–ë–∞–∑–æ–≤–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥."""
    stars = calculate_stars(
        messages_count=1,
        correctness_score=50,
        streak_days=0
    )
    assert stars == 1

def test_calculate_stars_with_bonus():
    """–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å –±–æ–Ω—É—Å–æ–º –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å."""
    stars = calculate_stars(
        messages_count=1,
        correctness_score=85,
        streak_days=0
    )
    assert stars == 2  # 1 –±–∞–∑–æ–≤–∞—è + 1 –±–æ–Ω—É—Å
```

## Frontend (Jest + React Testing Library)

```typescript
// __tests__/components/StreakCalendar.test.tsx
import { render, screen } from '@testing-library/react';
import { StreakCalendar } from '@/components/StreakCalendar';

describe('StreakCalendar', () => {
  it('renders current streak', () => {
    render(
      <StreakCalendar
        streakData={[]}
        currentStreak={5}
        maxStreak={10}
      />
    );

    expect(screen.getByText('5')).toBeInTheDocument();
    expect(screen.getByText('days streak')).toBeInTheDocument();
  });
});
```

# === –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï ===

## Docker

### docker-compose.yml
```yaml
version: '3.8'

services:
  backend:
    build: ./backend
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db:5432/mluv
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    depends_on:
      - db

  bot:
    build: ./bot
    environment:
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - BACKEND_URL=http://backend:8000
    depends_on:
      - backend

  webapp:
    build: ./webapp
    ports:
      - "3000:3000"
    environment:
      - NEXT_PUBLIC_API_URL=http://backend:8000

  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=mluv
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pass
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Backend (.env)
```
DATABASE_URL=postgresql://user:pass@localhost:5432/mluv
OPENAI_API_KEY=sk-...
TELEGRAM_BOT_TOKEN=...
TELEGRAM_WEBAPP_SECRET=...
LOG_LEVEL=INFO
SENTRY_DSN=... (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

### Bot (.env)
```
TELEGRAM_BOT_TOKEN=...
BACKEND_URL=http://localhost:8000
```

### WebApp (.env.local)
```
NEXT_PUBLIC_API_URL=http://localhost:8000
```

# === ROADMAP ===

## V1 (MVP) - 3-4 –Ω–µ–¥–µ–ª–∏

### –ù–µ–¥–µ–ª—è 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- [x] Docker-compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [x] Backend: FastAPI + SQLAlchemy + Alembic
- [x] Bot: aiogram –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- [x] WebApp: Next.js –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- [x] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: —Å—Ö–µ–º–∞ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ù–µ–¥–µ–ª—è 2: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [ ] Backend: –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö
- [ ] OpenAI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (STT, LLM, TTS)
- [ ] Bot: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] Bot: –ö–æ–º–∞–Ω–¥—ã /start, /help, /stats
- [ ] –ë–∞–∑–æ–≤–∞—è –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è (–∑–≤–µ–∑–¥—ã, streak)

### –ù–µ–¥–µ–ª—è 3: WebApp
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram WebApp
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–≤–µ–∑–¥
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –ù–µ–¥–µ–ª—è 4: –ü–æ–ª–∏—Ä–æ–≤–∫–∞
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è LLM
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –î–µ–ø–ª–æ–π –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω

## V1.5 - –£–ª—É—á—à–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

- [ ] Shadowing —Ä–µ–∂–∏–º (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —ç—Ç–∞–ª–æ–Ω–æ–º)
- [ ] –†–æ–ª–µ–≤—ã–µ –º–∏–Ω–∏-–¥–∏–∞–ª–æ–≥–∏ (2-3 —à–∞–≥–∞)
- [ ] –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏—è
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞—á–∏–≤–∫–∏
- [ ] –†–µ–∂–∏–º—ã: —Å—Ç—Ä–æ–≥–∏–π, –º—è–≥–∫–∏–π, –¥—Ä—É–≥, –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä

## V2 - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ–∏—á–∏

- [ ] –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏ –ø–æ –æ—à–∏–±–∫–∞–º
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Anki –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫
- [ ] –ì—Ä—É–ø–ø–æ–≤—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏
- [ ] –ü–æ–¥–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ Telegram Stars
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (React Native)

# === –†–£–ö–û–í–û–î–°–¢–í–û –î–õ–Ø AI ===

ai_guidance:
  - –°–ª–µ–¥–æ–≤–∞—Ç—å –≤—Å–µ–º –ø—Ä–∞–≤–∏–ª–∞–º, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –∏–Ω–∞—á–µ
  - –ü—Ä–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –∫–æ–¥–∞ –æ–±—ä—è—Å–Ω—è—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
  - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å async/await –¥–ª—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π
  - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å type hints –∏ docstrings
  - –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã
  - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å—é
  - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ gracefully —Å fallback
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Pydantic –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
  - –°–ª–µ–¥–æ–≤–∞—Ç—å Clean Architecture –ø—Ä–∏–Ω—Ü–∏–ø–∞–º
  - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ API
  - –ü–∏—Å–∞—Ç—å —á–∏—Ç–∞–µ–º—ã–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∫–æ–¥
  - –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å OpenAI API —É—á–∏—Ç—ã–≤–∞—Ç—å rate limits –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å
  - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
  - –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ (–ø–µ—Ä–µ–≤–æ–¥—ã, —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WebApp –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö UI, –±–æ—Ç–∞ - –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
  - –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –≥–æ–ª–æ—Å–æ–≤—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

# === –õ–£–ß–®–ò–ï –ü–†–ê–ö–¢–ò–ö–ò ===

## –†–∞–±–æ—Ç–∞ —Å OpenAI API

### Rate Limiting
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å exponential backoff –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–º–ø—Ç—ã
- –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JSON mode –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```python
from openai import OpenAI, RateLimitError, APIError
import asyncio

async def call_openai_with_retry(func, max_retries=3):
    """–í—ã–∑–æ–≤ OpenAI API —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏."""
    for attempt in range(max_retries):
        try:
            return await func()
        except RateLimitError:
            if attempt == max_retries - 1:
                raise
            await asyncio.sleep(2 ** attempt)  # exponential backoff
        except APIError as e:
            logger.error(f"OpenAI API error: {e}")
            raise
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### Backend
- Connection pooling –¥–ª—è PostgreSQL
- Async –≤–µ–∑–¥–µ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (Redis)
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏

### WebApp
- Server Components –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- Client Components —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- Image optimization —Å next/image
- Code splitting –∏ lazy loading

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram WebApp
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å—å initData
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
- –ù–µ –¥–æ–≤–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–º –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

### API Security
- Rate limiting –Ω–∞ –≤—Å–µ endpoints
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Pydantic
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è WebApp

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å .env —Ñ–∞–π–ª—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –†–æ—Ç–∞—Ü–∏—è API –∫–ª—é—á–µ–π —Ä–µ–≥—É–ª—è—Ä–Ω–æ

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
import structlog

logger = structlog.get_logger()

logger.info(
    "voice_message_processed",
    user_id=user_id,
    duration_seconds=duration,
    correctness_score=score,
    words_count=words_count
)
```

### –ú–µ—Ç—Ä–∏–∫–∏ (–±—É–¥—É—â–µ–µ)
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ OpenAI
- –°—Ç–æ–∏–º–æ—Å—Ç—å API –≤—ã–∑–æ–≤–æ–≤
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (DAU, MAU)
- Retention rate

# === –û–ë–©–ò–ï –ü–ê–¢–¢–ï–†–ù–´ ===

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ endpoint –≤ backend

1. –°–æ–∑–¥–∞—Ç—å Pydantic —Å—Ö–µ–º—É –≤ `schemas/`
2. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å `services/`
3. –°–æ–∑–¥–∞—Ç—å endpoint –≤ `routers/`
4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –≤ `tests/test_routers/`
5. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã –≤ –±–æ—Ç–∞

1. –°–æ–∑–¥–∞—Ç—å handler –≤ `bot/handlers/`
2. –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤ `bot/keyboards/` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `bot/main.py`
4. –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ BotFather
5. –û–±–Ω–æ–≤–∏—Ç—å /help —Ç–µ–∫—Å—Ç

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ WebApp

1. –°–æ–∑–¥–∞—Ç—å `app/{page}/page.tsx`
2. –°–æ–∑–¥–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `components/`
3. –î–æ–±–∞–≤–∏—Ç—å API –∫–ª–∏–µ–Ω—Ç –º–µ—Ç–æ–¥—ã –≤ `lib/api.ts`
4. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –≤ layout
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Telegram WebApp

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞

1. –î–æ–±–∞–≤–∏—Ç—å —è–∑—ã–∫ –≤ enum (backend/models/)
2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è i18n)
3. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è LLM
4. –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WebApp
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ–ª–æ—É

# === –ü–†–ò–ú–ï–†–´ –ö–û–î–ê ===

## Backend: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

```python
# routers/lesson.py
from fastapi import APIRouter, UploadFile, Depends
from services.openai_client import OpenAIClient
from services.correction_engine import CorrectionEngine
from schemas.lesson import LessonResponse

router = APIRouter(prefix="/api/v1/lessons", tags=["lessons"])

@router.post("/process", response_model=LessonResponse)
async def process_voice_message(
    audio: UploadFile,
    user_id: int,
    openai_client: OpenAIClient = Depends(),
    correction_engine: CorrectionEngine = Depends()
):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è."""
    # 1. STT
    transcript = await openai_client.transcribe(audio.file)

    # 2. –ê–Ω–∞–ª–∏–∑ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    corrections = await correction_engine.analyze(
        text=transcript,
        user_id=user_id
    )

    # 3. TTS
    audio_response = await openai_client.synthesize(
        text=corrections.response_text,
        voice=user.settings.voice,
        speed=user.settings.voice_speed
    )

    # 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    await save_message(user_id, transcript, corrections)

    # 5. –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥
    await award_stars(user_id, corrections.correctness_score)

    return LessonResponse(
        transcript=transcript,
        corrections=corrections,
        audio_response=audio_response
    )
```

## Bot: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ

```python
# bot/handlers/voice.py
from aiogram import Router, F
from aiogram.types import Message, FSInputFile
from services.api_client import APIClient

router = Router()

@router.message(F.voice)
async def handle_voice(message: Message, api_client: APIClient):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è."""
    # –ü–æ–∫–∞–∑–∞—Ç—å typing
    await message.bot.send_chat_action(
        chat_id=message.chat.id,
        action="typing"
    )

    # –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
    file = await message.bot.get_file(message.voice.file_id)
    audio_bytes = await message.bot.download_file(file.file_path)

    # –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ backend
    response = await api_client.process_voice(
        user_id=message.from_user.id,
        audio=audio_bytes
    )

    # –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–π –æ—Ç–≤–µ—Ç
    await message.answer_voice(
        voice=FSInputFile.from_bytes(response.audio_response),
        caption=f"‚úÖ Correctness: {response.correctness_score}%"
    )

    # –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    if response.corrections.mistakes:
        mistakes_text = "\n".join([
            f"‚ùå {m.original} ‚Üí ‚úÖ {m.corrected}\nüí° {m.explanation}"
            for m in response.corrections.mistakes
        ])
        await message.answer(mistakes_text)
```

## WebApp: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è

```tsx
// app/page.tsx
import { StreakCalendar } from '@/components/StreakCalendar';
import { StatCard } from '@/components/StatCard';
import { getStats } from '@/lib/api';

export default async function ProfilePage() {
  const stats = await getStats();

  return (
    <div className="min-h-screen bg-[var(--tg-theme-bg-color)] p-4">
      <header className="mb-6">
        <h1 className="text-2xl font-bold">Profile</h1>
      </header>

      <StreakCalendar
        streakData={stats.daily_stats}
        currentStreak={stats.current_streak}
        maxStreak={stats.max_streak}
      />

      <div className="grid grid-cols-2 gap-4 mt-6">
        <StatCard
          value={stats.words_said}
          label="Words Said"
        />
        <StatCard
          value={stats.max_streak}
          label="Max streak"
        />
        <StatCard
          value={`${stats.correct_percent}%`}
          label="Correct"
        />
        <StatCard
          value={stats.messages_sent}
          label="Messages Sent"
        />
      </div>
    </div>
  );
}
```

# === –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï ===

–≠—Ç–æ—Ç —Ñ–∞–π–ª `.cursorrules` —è–≤–ª—è–µ—Ç—Å—è –∂–∏–≤—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∏ –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞.

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –Ω–µ—è—Å–Ω–æ—Å—Ç–µ–π - –æ–±—Ä–∞—â–∞–π—Å—è –∫ —ç—Ç–æ–º—É —Ñ–∞–π–ª—É.
–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏–ª–∏ —Å–æ–≥–ª–∞—à–µ–Ω–∏–π - –æ–±–Ω–æ–≤–ª—è–π —ç—Ç–æ—Ç —Ñ–∞–π–ª.

–£–¥–∞—á–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ Mluv.Me! üöÄ
